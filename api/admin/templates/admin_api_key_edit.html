{% extends "base.html" %}
{% block title %}{{ t.edit_key }} - {{ api_key.prefix }} - {{ t.title }}{% endblock %}
{% block content %}
  <h1>{{ t.edit_key }}: {{ api_key.prefix }}{% if api_key.name %} ({{ api_key.name }}){% endif %}</h1>
  {% if request.query_params.get('generated_key') %}
  <div class="notice">
    {{ t.generated_key }}: <code>{{ request.query_params.get('generated_key') }}</code>
  </div>
  {% endif %}
  <p><a href="/admin/ui/api-keys?lang={{ lang }}">{{ t.back_to_api_keys }}</a></p>
  <div class="card">
    <div class="card-body">
      <h3>{{ t.name }}</h3>
      <form method="post" action="/admin/ui/api-keys/{{ api_key.id }}/update">
        <input type="hidden" name="lang" value="{{ lang }}" />
        <label for="name">{{ t.key_name }}</label>
        <input id="name" name="name" value="{{ api_key.name or '' }}" placeholder="{{ t.key_name_optional }}" />
        <div class="form-actions"><button type="submit" class="btn btn-primary">{{ t.save }}</button></div>
      </form>
      <h3 style="margin-top:1.25rem;">{{ t.key }}</h3>
      <p><code>{{ api_key.raw_key[:6] }}****{{ api_key.raw_key[-4:] if api_key.raw_key|length > 10 else '****' }}</code></p>
      <div class="form-actions" style="margin-top:0.75rem;">
        <form method="post" action="/admin/ui/api-keys/{{ api_key.id }}/regenerate" class="inline-form" onsubmit="return confirm('{{ t.regenerate_key }}?');">
          <button type="submit" class="btn btn-secondary">{{ t.regenerate_key }}</button>
        </form>
        <form method="post" action="/admin/ui/api-keys/{{ api_key.id }}/toggle-enabled" class="inline-form">
          {% if api_key.enabled %}
          <button type="submit" class="btn btn-secondary">{{ t.disable }}</button>
          {% else %}
          <button type="submit" class="btn btn-primary">{{ t.enable }}</button>
          {% endif %}
        </form>
        <a href="/admin/ui/api-keys/{{ api_key.id }}/databases?lang={{ lang }}" class="btn btn-secondary">{{ t.manage_databases }}</a>
        <form method="post" action="/admin/ui/api-keys/{{ api_key.id }}/delete" class="inline-form" onsubmit="return confirm('{{ t.delete }}?');">
          <button type="submit" class="btn btn-danger">{{ t.delete }}</button>
        </form>
      </div>
    </div>
  </div>
{% endblock %}
